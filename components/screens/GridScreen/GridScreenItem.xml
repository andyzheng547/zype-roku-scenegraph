<?xml version="1.0" encoding="utf-8" ?>
<!--********** Copyright 2016 Roku Corp.  All Rights Reserved. **********-->


<component name="GridScreenItem" extends="Group">

<interface>
  <field id="itemContent" type="node" onChange="itemContentChanged" alwaysNotify="true"/>
</interface>

<script type="text/brightscript" >
<![CDATA[
  function itemContentChanged() as void
    itemData = m.top.itemContent
    m.itemImage.uri = itemData.HDPOSTERURL

    offset = m.itemImage.width - 32 - 5
    m.statusImage.translation = [offset, 5]
    m.statusImage.visible = false

    print "m.global.auth.isLoggedInWithSubscription: "; m.global.auth.isLoggedInWithSubscription 
    if(itemData.ContentType = 4 AND itemData.SubscriptionRequired = true AND m.global.enable_lock_icons = true)
      m.statusImage.visible = true

      if(m.global.auth.isLoggedInWithSubscription = true AND ((m.global.usvod.UniversalSubscriptionsCount <> invalid AND m.global.usvod.UniversalSubscriptionsCount > 0) OR m.global.nsvod.HasNativeSubscription = true))
        m.statusImage.uri = "pkg:/images/iconUnlocked.png"
      else
        m.statusImage.uri = "pkg:/images/iconLocked.png"
      end if
    end if
  end function

  function init() as void
    m.itemImage = m.top.findNode("itemImage")
    m.statusImage = m.top.findNode("statusImage")
  end function
]]>
</script>

<children>
    <LayoutGroup layoutDirection="vert" vertAlignment="top" horizAlignment="custom" translation="[0,0]" >
        <Group>
          <Poster id="itemImage" translation="[0,0]" width="262" height="147" />
          <Poster id="statusImage" translation="[-50,-50]" width="32" height="32" visible="false" />
        </Group>

        <Label id="itemText" horizAlign="center" translation="[0,0]" font="font:MediumSystemFont" width="255" height="65" />
    </LayoutGroup>
</children>

</component>
